function [u] = Simulink_Control_PDCHinf(inputs)

s = inputs(1);
theta = inputs(2);
v = inputs(3);
omega = inputs(4);
alfa = inputs(5); % o parametro h depende de alfa
if theta == 0
   sinctheta = 1;
else 
    sinctheta = sin(theta)/theta;
end

x = [s;theta;v;omega];

%Khinf =[(998896171011007622377296295114535839203328*omega*sin(2*theta))/20902572435982864045637798257827130980694864095 - (180224350639575680896835148435229474270962088016*cos(theta))/20902572435982864045637798257827130980694864095 + (90112175319787840448417574217614737135481044008*2^(1/2))/20902572435982864045637798257827130980694864095 + (10935396730007906728881265100664*sinctheta*cos(alfa))/1584640114669493932916943930401 - (619252958944332007574633592*omega*sin(theta))/7923200573347469664584719652005 - (998896171011007622377296295114535839203328*2^(1/2)*omega*sin(theta))/20902572435982864045637798257827130980694864095 - (92625860224185348581893223068566918213142577152*sinctheta*cos(alfa)*cos(theta))/20902572435982864045637798257827130980694864095 + (46312930112092674290946611534283459106571288576*2^(1/2)*sinctheta*cos(alfa))/20902572435982864045637798257827130980694864095 + (658574427536181135142813696*omega*sinctheta*cos(alfa)*sin(theta))/7923200573347469664584719652005 + (1710272140823114648343869127426667062493184*2^(1/2)*omega*sinctheta*cos(alfa)*sin(theta))/20902572435982864045637798257827130980694864095 - (3420544281646229296687738254853334124986368*omega*sinctheta*cos(alfa)*cos(theta)*sin(theta))/20902572435982864045637798257827130980694864095 + 13104239896567420806405339038923789995902385187/1784146157485468232122025132775963404716212224, (1278920875974420990808676103400041484577925800288*cos(theta))/20902572435982864045637798257827130980694864095 - (14423546884192311087852680237135705248104448*omega*sin(2*theta))/20902572435982864045637798257827130980694864095 - (639460437987210495404338051700020742288962900144*2^(1/2))/20902572435982864045637798257827130980694864095 - (8682423796359766256350903117376*sinctheta*cos(alfa))/149494350440518295558202257585 + (5093257845280498461299298336*omega*sin(theta))/7923200573347469664584719652005 + (14423546884192311087852680237135705248104448*2^(1/2)*omega*sin(theta))/20902572435982864045637798257827130980694864095 + (270150948571859795624699814889175950408990851072*sinctheta*cos(alfa)*cos(theta))/6967524145327621348545932752609043660231621365 - (135075474285929897812349907444587975204495425536*2^(1/2)*sinctheta*cos(alfa))/6967524145327621348545932752609043660231621365 - (99239163696140378141884416*omega*sinctheta*cos(alfa)*sin(theta))/149494350440518295558202257585 - (20911816111158711518141136023208688315531264*2^(1/2)*omega*sinctheta*cos(alfa)*sin(theta))/20902572435982864045637798257827130980694864095 + (41823632222317423036282272046417376631062528*omega*sinctheta*cos(alfa)*cos(theta)*sin(theta))/20902572435982864045637798257827130980694864095 - 138235089261132548351453459215557706968206772109/2230182696856835290152531415969954255895265280, (15033435708546400168761303399788034654208*omega*sin(2*theta))/131462719723162666953696844388849880381728705 - (5799128352955623463498605317773524366380959376*cos(theta))/394388159169488000861090533166549641145186115 + (2899564176477811731749302658886762183190479688*2^(1/2))/394388159169488000861090533166549641145186115 + (5134572861361659986368400232576*sinctheta*cos(alfa))/466070621961615862622630567765 - (990607477929195957382525104*omega*sin(theta))/7923200573347469664584719652005 - (15033435708546400168761303399788034654208*2^(1/2)*omega*sin(theta))/131462719723162666953696844388849880381728705 - (151817549208931696314146297948111743583493554176*sinctheta*cos(alfa)*cos(theta))/20902572435982864045637798257827130980694864095 + (75908774604465848157073148974055871791746777088*2^(1/2)*sinctheta*cos(alfa))/20902572435982864045637798257827130980694864095 + (63376923482339438290272256*omega*sinctheta*cos(alfa)*sin(theta))/466070621961615862622630567765 + (3493400688837428452273805776484357894045696*2^(1/2)*omega*sinctheta*cos(alfa)*sin(theta))/20902572435982864045637798257827130980694864095 - (6986801377674856904547611552968715788091392*omega*sinctheta*cos(alfa)*cos(theta)*sin(theta))/20902572435982864045637798257827130980694864095 + 66175411405432107466417911146983570678922078847/4460365393713670580305062831939908511790530560, (283213035214647220482746544794416185219092310368*cos(theta))/20902572435982864045637798257827130980694864095 - (2809952731205820302815854833913811756384256*omega*sin(2*theta))/20902572435982864045637798257827130980694864095 - (141606517607323610241373272397208092609546155184*2^(1/2))/20902572435982864045637798257827130980694864095 - (64267505539036767211139680529344*sinctheta*cos(alfa))/7923200573347469664584719652005 + (714095517596850477931415834976*omega*sin(theta))/7923200573347469664584719652005 + (2809952731205820302815854833913811756384256*2^(1/2)*omega*sin(theta))/20902572435982864045637798257827130980694864095 + (110258795271631099753819129547237931425397211136*sinctheta*cos(alfa)*cos(theta))/20902572435982864045637798257827130980694864095 - (55129397635815549876909564773618965712698605568*2^(1/2)*sinctheta*cos(alfa))/20902572435982864045637798257827130980694864095 - (1063484541800635259617804288*omega*sinctheta*cos(alfa)*sin(theta))/7923200573347469664584719652005 - (4153944517265599849518437596412691116720128*2^(1/2)*omega*sinctheta*cos(alfa)*sin(theta))/20902572435982864045637798257827130980694864095 + (8307889034531199699036875192825382233440256*omega*sinctheta*cos(alfa)*cos(theta)*sin(theta))/20902572435982864045637798257827130980694864095 - 32314627903725123061093095673113217620830109067/2230182696856835290152531415969954255895265280];
Khinf = [(2265099227327727461285329789690659627616621159*cos(theta))/12667421713107130840742816298064767582127080960 + (1053088623039212288543691717284826621461737909*sinctheta*cos(alfa))/12667421713107130840742816298064767582127080960 - (1011133725246795274005626283773338951622099*omega*sin(theta))/10556184760922609033952346915053972985105900800 - (2627791845342423002521981501507574532407296*sinctheta*cos(alfa)*cos(theta))/24741058033412364923325813082157749183841955 + (501945280876260165779813716222155948032*omega*cos(theta)*sin(theta))/123705290167061824616629065410788745919209775 + (932658062926932942710506894135075536896*omega*sinctheta*cos(alfa)*sin(theta))/9515791551312448047433005031599134301477675 + (153375835269846627448826763939669868544*omega*sinctheta*cos(alfa)*cos(theta)*sin(theta))/9515791551312448047433005031599134301477675 + 91515140749400746636950150727163871471169594654228132351199737/38032663804596136360285922287243905714584678538775037938237440, (1442432126290659325940007058981421577524521*omega*sin(theta))/123705290167061824616629065410788745919209775 - (4313346054632105243851567773700222086505797329*sinctheta*cos(alfa))/49482116066824729846651626164315498367683910 - (270139279815030511923718100288941957725331983*cos(theta))/5498012896313858871850180684923944263075990 + (1528396333096746980546281956793188519470170112*sinctheta*cos(alfa)*cos(theta))/24741058033412364923325813082157749183841955 - (9023382578844782815598677193575486193664*omega*cos(theta)*sin(theta))/13745032240784647179625451712309860657689975 - (1468767213341976916229470611001260296372224*omega*sinctheta*cos(alfa)*sin(theta))/123705290167061824616629065410788745919209775 - (231462657925536340384975561381382881017856*omega*sinctheta*cos(alfa)*cos(theta)*sin(theta))/123705290167061824616629065410788745919209775 - 114444832857185181638663161306450258602971265455305399346241131/445695278960110972972100651803639520092789201626269975838720, (583061198352864358579628782346799867021858953*cos(theta))/879682063410217419496028909587831082092158400 + (2497322470981289289632175350245028666183414503*sinctheta*cos(alfa))/7917138570691956775464260186290479738829425600 - (331889184511249902415733521423206622790359*omega*sin(theta))/791713857069195677546426018629047973882942560 - (50518720385862991177352651152251794501926912*sinctheta*cos(alfa)*cos(theta))/123705290167061824616629065410788745919209775 + (81181226048644238558303687659166367744*omega*cos(theta)*sin(theta))/2749006448156929435925090342461972131537995 + (814173670328209214011344896046565163008*omega*sinctheta*cos(alfa)*sin(theta))/1903158310262489609486601006319826860295535 + (21530728532226419327071129767510016000*omega*sinctheta*cos(alfa)*cos(theta)*sin(theta))/380631662052497921897320201263965372059107 + 838030469070515850267988349289835491916619676596106087753638861/71311244633617755675536104288582323214846272260203196134195200, (1074672009661435906570458671209255815933478721*cos(theta))/3958569285345978387732130093145239869414712800 - (2500971217781022514207205389851628306005944291*sinctheta*cos(alfa))/3958569285345978387732130093145239869414712800 + (182025736998498827887254055973382168709186861*omega*sin(theta))/1979284642672989193866065046572619934707356400 + (85969115525373218084690905869301636533321728*sinctheta*cos(alfa)*cos(theta))/123705290167061824616629065410788745919209775 - (15417143239466654717667099974138337427456*omega*cos(theta)*sin(theta))/123705290167061824616629065410788745919209775 - (249246656117254031491346418474030353874944*omega*sinctheta*cos(alfa)*sin(theta))/123705290167061824616629065410788745919209775 - (35222449144206763451683626614054627311616*omega*sinctheta*cos(alfa)*cos(theta)*sin(theta))/123705290167061824616629065410788745919209775 - 1952739406953609716015732796730406747785046844888646439440872547/35655622316808877837768052144291161607423136130101598067097600];

u = Khinf*x;

end

